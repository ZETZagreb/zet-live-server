<!DOCTYPE html>
<html>
<head>
    <title>ZET Live - Emoji Ikone</title>
    <meta charset="utf-8" />
    <style>
        #map { height: 100vh; width: 100%; background-color: #a3ccff; }
        body { margin: 0; padding: 0; }
        .vozilo-ikona {
            font-size: 24px;
            background: white;
            border: 2px solid blue;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            width: 30px !important;
            height: 30px !important;
        }
        .ikona-bus { border-color: orange; }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        window.onload = function() {
            var map = L.map('map').setView([45.815, 15.981], 13);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);

            var markers = {};
            var povijestBrzina = {};
            var zadnjeVrijeme = Date.now();

            function getDistance(lat1, lon1, lat2, lon2) {
                var R = 6371e3;
                var dLat = (lat2 - lat1) * Math.PI / 180;
                var dLon = (lon2 - lon1) * Math.PI / 180;
                var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                        Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                        Math.sin(dLon/2) * Math.sin(dLon/2);
                var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                return R * c;
            }

            async function osvjezi() {
                try {
                    const sad = Date.now();
                    const dt = (sad - zadnjeVrij
